iosアプリ、Androidアプリ、webアプリ
アプリ名: EconoBook

### **1. 基本的な金融・取引機能**

* **コミュニティ内通貨の発行**
  各コミュニティが自由に独自通貨を設定できる。自分でコミュニティを作成可能だし、存在するコミュニティに参加も可能。
  独自の中央銀行を設置でき、通貨の発行枚数や単位、借入制限や利息など、自由に銀行システムを構築できる。
  その通貨を利用し、家族であれば家事の手伝いや、学生であれば課題の手伝いなど、そのコミュニティにあった取引が可能である。
  また、先に自分の報酬通貨料と仕事内容を決めることも可能ですし、トークで話し合って決めることも可能。
* **複数通貨対応**
  独自通貨と円（実通貨）を関連させることもできる。「日本円 = 独自通貨×数字」　のように。ただし、アプリ内での実通貨を移動させることは考えていない。ペイペイなどの送金リンクを作成できるまでとし、お互いの認証により円として交換記録を残すことも可能。
* **送金・受取・請求**
  個人間・グループ間でお金や通貨をやりとりできる。
* **割り勘機能**
  食事会などで自動計算して精算。
* **月次まとめ払い**
  家族や友人間の取引を一度に精算（振込手数料の削減にもつながる）。

### **2. SNS的機能**

* **コミュニティ作成・参加機能**
  家族、サークル、会社など自由にグループを作れる。
* **取引履歴のタイムライン表示**
  （プライベート設定を含めて）活動や取引のログを見られる。
* **ニュース/トラブル共有欄**
  他コミュニティの問題事例を共有、仲裁や学びに使える。
* **プロフィール/信用スコア**
  取引履歴から「信用度」「信頼スコア」を可視化。
* 全体共通の通貨として仮名「信用スコア」を作成する。
  この通貨はトラブルの仲介に入って解決したなどにより、恩恵を受けた人から信用スコアが渡される。これは累積されていく。
  信用スコアの使い道は他にも考えていく。

### **3. 分析機能**

* **グラフ表示**
  支出・収入を円グラフや棒グラフで可視化。
* **予算設定とアラート**
  月ごとに「交際費1万円まで」など設定でき、超えると通知。

### **4. セキュリティ・認証**

* **二段階認証**（Google/LINE連携など）
* **トランザクション承認**
  PIN/生体認証で送金を確認。
* **取引の非公開設定**
  公開範囲を「本人のみ」「コミュニティ内」「全体」から選択。

---

## **🔹 非機能要件（Non-functional Requirements）**

* **UX/UI**
  * LINE感覚で使えるシンプルな操作感
  * アプリ色（ブルーやグリーン系で「金融」「安心感」を表現）
* **パフォーマンス**
  * 1秒以内のレスポンスで送金・表示が行える
* **スケーラビリティ**
  * コミュニティ数・ユーザー数が増えても耐えられる設計
* **セキュリティ**
  * 金融取引のため暗号化・データ保護必須
  * 不正検知・アラート機能
* **法令遵守**
  * 資金決済法や電子マネー規制に準拠

---

## **🔹 ユーザーが喜ぶポイント**

1. **「家族でも友達でも使える」柔軟さ**
   → 家計簿、割り勘、授業の代行など多様なケースに対応。
2. **「実際のお金＋仮想通貨」両方扱える**
   → 遊びの通貨と現金の使い分け。
3. **「信頼感」**
   → 透明性のある履歴と信用スコアで安心してやり取りできる。
4. **「便利さ」**
   → 毎回送金する必要がなく月次まとめ払いで楽。
5. **「学び・安全」**
   → ニュース/トラブル共有から知見を得て、安心感も高まる。



「**仮想通貨・ポイント型の金融系SNS**」として、**個人開発でも始めやすく、法規制のハードルを下げる前提**で要件をまとめます。Flutter＋Firebase（Auth/Firestore/Functions）前提に落とし込みも付けました。

# **1) プロダクト方針（コンプラ前提）**

* **法的位置付け：****ゲーム内ポイント/コミュニティ内ポイント**
  * **現金等価ではない（** **換金不可** **・** **利息不可** **・** **外部送金不可** **）**
  * 利用規約に「ポイントは事業者の裁量で付与/没収/失効可」「金銭請求権なし」を明記
* 実通貨は**外部決済サービス**（PayPay/Stripe/銀行振込など）へリンクのみ（アプリ外で精算）
* コミュニティ間のポイント相互交換は当面なし（相場/両替回避）
* **年齢制限・未成年保護**：親権者同意、上限額/時間制限
* **禁止用途**：報酬型バイト仲介などのグレー行為を規約で抑止、通報・BAN

# **2) コア機能（MVP）**

## **A. コミュニティ＆ポイント**

* コミュニティ作成/参加（招待コード or 承認制）
* コミュニティごとの**独自ポイント**（名称/シンボル/桁数/失効期限/上限）
* 権限ロール：Owner / Admin / Member（鑑定人/仲介人は拡張）

## **B. 取引（ポイント）**

* **P2P送受信** **／** **請求（Request）** **／****割り勘（Split）**
* **月次まとめ精算（擬似）**
  * 月末にコミュニティが**ネット債権マトリクス**を提示 → 外部決済で実際に送金（アプリ内は「完了チェック」）
* **タスク型取引**（大学の課題手伝い等）：
  * 投稿（タイトル/報酬ポイント/締切）→ 申込 → 完了承認で自動送付

## **C. タイムライン / SNS**

* 取引・タスクの**活動ログ**（公開範囲：本人/コミュ内/全体）
* **ニュース/トラブル掲示板**（事例共有、学び、仲介募集）
* いいね/コメント/通報

## **D. 家計簿・可視化**

* カテゴリ自動付与（フード/交通/学業…）
* **ダッシュボード**：月次支出・ポイント収支・トップ相手・タグ別
* 予算アラート（カテゴリ上限）

## **E. 信用/安全**

* **信用スコア**（遅延率、完了率、相手評価、通報率）
* **エスクロー風の承認フロー**（タスク完了→発注者承認→送付）
* 通報・モデレーション（違反回数で自動制限）

# **3) 非機能要件**

* **パフォーマンス**：主要画面<1s表示、一覧は無限スクロール
* **スケーラビリティ** **：ポイントは****二重仕訳台帳**で整合性担保
* **セキュリティ**：Auth必須／Cloud Functions経由で**サーバーサイド検証**／Cloud Logging
* **プライバシー**：公開範囲の既定値は「コミュ内」、未成年はさらに制約
* **信頼性**：冪等エンドポイント（重複送信防止）、整合性ジョブ（夜間検算）

# **4) データモデル（Firestore案）**

```
users/{uid}
  displayName, photoUrl, dob, role, communityIds[]
  score: {trust, completionRate, disputeRate, lastCalcAt}

communities/{cid}
  name, icon, ownerUid, policy, point: {symbol, decimals, expireDays, dailyCap}

memberships/{cid_uid}
  cid, uid, role, joinedAt, balance  // ← 集計キャッシュ（正は受取超過）

ledger/{cid}/entries/{entryId}  // 二重仕訳
  ts, type: 'transfer'|'request'|'split'|'task',
  fromUid, toUid, amount, memo, status:'pending|posted|reversed',
  lines: [
    {uid:A, delta:-100}, {uid:B, delta:+100}
  ],
  requestRef, taskRef, splitGroupId, createdBy, idempotencyKey

requests/{cid}/{reqId}
  fromUid, toUid, amount, memo, status, expireAt

tasks/{cid}/{taskId}
  title, desc, reward, deadline, status, assigneeUid, proofUrl

news/{cid}/{postId}
  category:'lesson|trouble|mediator', body, visibility, reports[], comments[]
```

> **ポイント計算**は**ledger.linesの総和＝0**、ユーザ残高は定期ジョブで再集計 or トランザクションで更新。

> **idempotencyKey**で多重POST防止。

# **5) セキュリティルール（要点）**

* 取引作成は**Cloud Functions**のみ許可（クライアント直書き禁止）
* **所有者本人以外は自残高更新不可**
* 可視性：**visibility**に応じて読取制御
* 児童保護：未成年は夜間投稿制限/高額上限

# **6) ワークフロー（主要ユースケース）**

1. **送金**：A→Bへ100pt請求 → B承認 → Functionsが二重仕訳→**posted**
2. **タスク**：Aが課題手伝い募集（100pt）→ Bが完了提出 → A承認→送付
3. **割り勘**：レシート金額入力→参加者選択→自動按分→各自に請求→承認
4. **月次まとめ**：コミュのネット債権算出→外部決済リンク共有→完了チェック

# **7) 画面（Flutter想定）**

* **Home**：検索/フィルタ（内部/外部）＋直近取引＋タスク
* **Talk/コミュ**：スレッド＋ポイント小計＋割り勘作成
* **Bank**：ポイント残高、入出力履歴、エクスポート
* **News**：事例/トラブル、仲介応募
* **Account**：本人設定、未成年モード、上限、通知設定

> ※今のコードではHomeScreen**が複数ファイルで重複定義されています（**sign_in_screen.dart**や**sign_up_screen.dart**内）。****クラス名を画面ごとに分離**（SignInScreen**, **SignUpScreen**, **HomeScreen**）し、**main.dart**の**if (user==null) return SignInScreen();** の****const**を外す**とホットリロードのエラーは消えます。**

# **8) ユーザーが特に喜ぶ差別化ポイント**

* **まとめ精算の強力UI**（「今月はA→B 1,240pt相当、C→D 820pt…」を自動提示）
* **信頼スコアの透明な算出式**（遅延・通報・相互評価を明示）
* **仲介ロール**と**エスカレーション**（揉めた時に第三者が入りやすい）
* **タスク市場**（授業・研究・日常の軽作業に即時ポイント）
* **学びのニュース欄**（失敗事例のテンプレ化→再発防止）

# **9) 開発ロードマップ**

* **M0（2–3週間）**：コミュ作成/参加・P2P送受信（Functions+二重仕訳）・家計簿自動分類
* **M1**：割り勘・請求、ダッシュボード、信用スコアv1
* **M2**：タスク市場、ニュース/トラブル、仲介ロール
* **M3**：月次まとめ精算の外部決済連携（リンク共有）・未成年モード

# **10) 失敗しない運用・法務メモ（軽量版）**

* **利用規約／プラポリ：ポイントは** **金銭債権でない** **、** **換金不可** **、** **有効期限** **、** **付与/失効** **、** **禁止行為** **、** **通報** **、****仲裁フロー**
* 監査ログ：全取引に署名・操作ユーザ・端末情報（不正検知）
* サポート：チャット通報→モデレーションキュー→SLA目標


通貨は信用ポイントに変換できたりする。
